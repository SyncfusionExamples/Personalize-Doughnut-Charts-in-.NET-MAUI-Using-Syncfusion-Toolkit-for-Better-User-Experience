<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:chart="clr-namespace:Syncfusion.Maui.Toolkit.Charts;assembly=Syncfusion.Maui.Toolkit"
             x:Class="CustomizeDoughnutChartUI.MainPage"
             xmlns:local="clr-namespace:CustomizeDoughnutChartUI">

    <ContentPage.BindingContext>
        <local:FreshWaterResourceViewModel />
    </ContentPage.BindingContext>

    <ContentPage.Resources>
        <local:ColorToWhiteTintConverter x:Key="ColorWithWhite" Ratio="0.4"/>
        <local:ColorToBlackTintConverter x:Key="ColorWithBlack" Ratio="0.2"/>
        <x:String x:Key="PathData">M11.199004,4.2629057C10.748999,4.9198881 10.229003,5.65585 9.6559969,6.4678618 6.6210018,10.760953 2.4670027,16.639859 2.1910015,20.325894 2.1880034,20.372891 2.1809996,20.419888 2.1710048,20.465909 2.056999,20.984952 1.9999999,21.519864 1.9999998,22.054898 1.9999999,26.435879 5.8369976,29.999966 10.553,29.999966 15.270003,29.999966 19.107001,26.435879 19.107001,22.054898 19.107001,21.583951 19.063002,21.113858 18.974997,20.656949 18.623,18.541958 17.071997,15.927945 15.429999,13.158902 13.676001,10.202969 11.880004,7.174893 11.199004,4.2629057z M11.93589,0.00082242517C12.027951,-0.0029162264 12.122065,0.0060316229 12.216002,0.028897136 12.714003,0.15096723 13.039,0.62997114 12.969,1.1379057 12.525,4.3418852 14.875998,8.3058745 17.15,12.138882 18.889998,15.072964 20.534003,17.84396 20.943997,20.303921 21.050999,20.860928 21.106999,21.457852 21.106999,22.054898 21.106999,27.53793 16.373,31.999966 10.553,31.999966 4.7340007,31.999966 1.6442618E-07,27.53793 0,22.054898 1.6442618E-07,21.399869 0.068000949,20.743863 0.20200374,20.1069 0.56100476,15.868863 4.8710018,9.7729155 8.0220028,5.3139311 9.4289995,3.3229643 10.759001,1.4408842 11.036002,0.66390668 11.176562,0.271443 11.536958,0.017022243 11.93589,0.00082242517z</x:String>
        <x:String x:Key="CenterViewPathData">M13.434021,18.613004C13.377014,18.615002 13.319031,18.628995 13.263,18.654004 13.041016,18.759 12.946045,19.023999 13.050049,19.244992 13.085022,19.320996 13.932007,21.061002 16.507996,21.061002 16.799011,21.059995 16.996033,20.85899 16.994995,20.613004 16.992004,20.367001 16.832031,20.162991 16.546997,20.173001 14.526001,20.232999 13.882019,18.925992 13.852051,18.865002 13.774048,18.699994 13.606018,18.606 13.434021,18.613004z M28.442993,15.967L31.106995,15.967C31.106995,24.297999 24.329041,31.074 16,31.074 10.794006,31.074 6.0030518,28.411998 3.2420044,24.057994L0,25.006999 2.2000122,15.973996 8.9219971,22.395993 5.9240112,23.272992C8.2470093,26.477992 11.973022,28.410991 16,28.410991 22.861023,28.410991 28.442993,22.828992 28.442993,15.967z M15.975037,8.6309956C15.975037,8.6309956 18.42804,12.485998 18.837036,12.933996 18.837036,12.933996 19.702026,14.164999 20.314026,15.396001 20.466003,15.663998 20.592041,15.946996 20.689026,16.242993 20.843018,16.665997 20.920044,17.017995 20.900024,17.290997 20.910034,17.420995 20.919006,17.551999 20.919006,17.682996 20.919006,20.311002 18.717041,22.443997 16,22.443997 13.282043,22.443997 11.079041,20.311002 11.079041,17.682996 11.079041,17.486996 11.096008,17.294995 11.119019,17.105L11.095032,17.106C11.095032,17.106 11.362,14.724996 13.317993,12.533994 13.317993,12.533994 15.488037,9.7020023 15.975037,8.6309956z M16,0C21.205994,1.8390119E-07,25.997009,2.6620024,28.757996,7.0159977L32,6.0670002 29.799011,15.098997 23.078003,8.6780003 26.07605,7.8010014C23.752014,4.596 20.026001,2.6630018 16,2.6630021 9.1390381,2.6630018 3.5570068,8.2450016 3.5570068,15.106001L0.89300537,15.106001C0.89300537,6.7759998,7.6700439,1.8390119E-07,16,0z</x:String>
    </ContentPage.Resources>

    <Border Stroke="LightGray" StrokeThickness="2" Margin="{OnPlatform Default=25,Android=5,iOS=5}" StrokeShape="RoundRectangle 10">
        <Grid>
            <chart:SfCircularChart Margin="10" Grid.Row="1">
                <chart:SfCircularChart.Resources>
                    <DataTemplate x:Key="labelTemplate">
                        <HorizontalStackLayout Spacing="5">
                            <Label Text="{Binding Item.Country}"
                                TextColor="{Binding Item.IconColor, Converter={StaticResource ColorWithBlack}}"
                                FontSize="Body"
                                FontAttributes="Bold">
                                <Label.IsVisible>
                                    <OnPlatform x:TypeArguments="x:Boolean">
                                        <On Platform="iOS" Value="False" />
                                        <On Platform="Android" Value="False" />
                                        <On Platform="UWP" Value="True" />
                                        <On Platform="WinUI" Value="True" />
                                    </OnPlatform>
                                </Label.IsVisible>
                            </Label>
                            <Label Text=": "
                                TextColor="{Binding Item.IconColor, Converter={StaticResource ColorWithBlack}}"
                                FontSize="Body">
                                <Label.IsVisible>
                                    <OnPlatform x:TypeArguments="x:Boolean">
                                        <On Platform="iOS" Value="False" />
                                        <On Platform="Android" Value="False" />
                                        <On Platform="UWP" Value="True" />
                                        <On Platform="WinUI" Value="True" />
                                    </OnPlatform>
                                </Label.IsVisible>
                            </Label>
                            <Label Text="{Binding Item.Percentage, StringFormat='{}{0} %'}"
                                TextColor="{Binding Item.IconColor, Converter={StaticResource ColorWithBlack}}"
                                FontSize="Body"
                                FontAttributes="Bold"/>
                        </HorizontalStackLayout>
                    </DataTemplate>
                    <DataTemplate x:Key="tooltipTemplate">
                        <VerticalStackLayout  Spacing="6" VerticalOptions="Center">
                            <HorizontalStackLayout Spacing="8" VerticalOptions="Center" HorizontalOptions="Center">
                                <Border
                                    Stroke="White"
                                    StrokeThickness="1"
                                    StrokeShape="RoundRectangle 15"
                                    VerticalOptions="Center"
                                    HorizontalOptions="Center"
                                    HeightRequest="18"
                                    WidthRequest="18">
                                    <Image
                                        Source="{Binding Item.IconName}"
                                        WidthRequest="16"
                                        HeightRequest="16"
                                        VerticalOptions="Center"
                                        HorizontalOptions="Center"/>
                                </Border>
                                <Label
                                    Text="{Binding Item.Country}"
                                    FontAttributes="Bold"
                                    FontSize="16"
                                    VerticalOptions="Center"
                                    TextColor="{Binding Item.IconColor, Converter={StaticResource ColorWithWhite}}"/>
                            </HorizontalStackLayout>
                            <BoxView VerticalOptions="Center"
                                Color="{Binding Item.IconColor, Converter={StaticResource ColorWithWhite}}"
                                HeightRequest="1.5"
                                Margin="0,2"/>
                            <Label
                                Text="{Binding Item.CubicMeters, StringFormat='{0:N0} Billion m³'}"
                                FontSize="14"
                                HorizontalOptions="Center"
                                VerticalOptions="Center"
                                TextColor="{Binding Item.IconColor, Converter={StaticResource ColorWithWhite}}"/>
                        </VerticalStackLayout>
                    </DataTemplate>
                </chart:SfCircularChart.Resources>

                <chart:SfCircularChart.Title>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Path Margin="0,10" Grid.Column="0" Grid.Row="0"
                              Data="{StaticResource PathData}"
                              Fill="Gray"
                              HeightRequest="35"
                              WidthRequest="30"
                              VerticalOptions="Center"/>
                        <Label Margin="0,10" Grid.Column="1" Grid.Row="0"
                               Text="Ranking of Countries by Freshwater Resources in 2021"
                               FontSize="{OnPlatform Default=26,Android=20,iOS=20}"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               HorizontalOptions="Start"/>
                    </Grid>
                </chart:SfCircularChart.Title>

                <chart:DoughnutSeries x:Name="doughnutSeries"
                    ItemsSource="{Binding FreshWaterResourcesData}"
                    LabelTemplate="{StaticResource labelTemplate}"                  
                    TooltipTemplate="{StaticResource tooltipTemplate}"
                    PaletteBrushes="{Binding SegmentBrushes}"
                    XBindingPath="Country"
                    YBindingPath="Percentage"
                    Radius="0.7"
                    InnerRadius="0.55"
                    ShowDataLabels="True"
                    EnableTooltip="True"
                    StartAngle="20"
                    EndAngle="380"
                    GapRatio="0.05">
                    <chart:DoughnutSeries.CenterView>
                        <Border HeightRequest="{Binding CenterHoleSize}" WidthRequest="{Binding CenterHoleSize}" Stroke="Transparent">
                            <Path Grid.Column="0"
                                  Data="{StaticResource CenterViewPathData}"
                                  Fill="#4dacff"
                                  Stroke="LightGray"
                                  StrokeThickness="1"
                                  HeightRequest="{OnPlatform Default=165,Android=100,iOS=100}"
                                  WidthRequest="{OnPlatform Default=165,Android=100,iOS=100}"
                                  HorizontalOptions="Center"
                                  VerticalOptions="Center">
                                <Path.RenderTransform>
                                    <TransformGroup>
                                        <TransformGroup.Children>
                                            <ScaleTransform ScaleX="{OnPlatform Default=5,Android=3,iOS=3}" ScaleY="{OnPlatform Default=5,Android=3,iOS=3}"/>
                                        </TransformGroup.Children>
                                    </TransformGroup>
                                </Path.RenderTransform>
                            </Path>
                        </Border>
                    </chart:DoughnutSeries.CenterView>
                    <chart:DoughnutSeries.DataLabelSettings>
                        <chart:CircularDataLabelSettings LabelPosition="Outside" SmartLabelAlignment="Shift">
                            <chart:CircularDataLabelSettings.ConnectorLineSettings>
                                <chart:ConnectorLineStyle ConnectorType="Curve" />
                            </chart:CircularDataLabelSettings.ConnectorLineSettings>
                        </chart:CircularDataLabelSettings>
                    </chart:DoughnutSeries.DataLabelSettings>
                </chart:DoughnutSeries>
            </chart:SfCircularChart>
        </Grid>
    </Border>
</ContentPage>